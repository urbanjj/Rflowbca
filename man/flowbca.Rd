% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/flowbca.R
\name{flowbca}
\alias{flowbca}
\title{A Flow-based Cluster Algorithm in R}
\usage{
flowbca(
  flow_input,
  opt_f = 1,
  q = NULL,
  k = NULL,
  la = NULL,
  lw = NULL,
  lm = NULL,
  smaller = NULL,
  non_zero = NULL,
  save_k = FALSE
)
}
\arguments{
\item{flow_input}{A data frame where the first column contains source unit identifiers
and subsequent columns represent the flows to destination units. The destination
columns must be in the same order as the source unit rows.}

\item{opt_f}{An integer specifying the optimization function:
1: Directed relative flows (default)
2: Undirected relative flows
3: Directed absolute flows
4: Undirected absolute flows}

\item{q}{A numeric flow threshold (can be relative or absolute) that will
adjust the default stopping criterion. The algorithm stops if the maximum
flow for merging is below this value. Defaults to 0.}

\item{k}{An integer specifying the desired number of distinct clusters. The
algorithm stops when this number of clusters is reached. Defaults to 1.}

\item{la}{A numeric value for the average of the internal relative flows of all
clusters. The algorithm terminates if the calculated average (La) exceeds
this value. Defaults to 1.1 (effectively off).}

\item{lw}{A numeric value for the weighted average of the internal relative flows
of all clusters. The algorithm terminates if the calculated weighted average
(Lw) exceeds this value. Defaults to 1.1 (effectively off).}

\item{lm}{A numeric value for the minimum internal relative flow. The algorithm
terminates if the calculated minimum (Lm) exceeds this value. Defaults to
1.1 (effectively off).}

\item{smaller}{A numeric value between 0 and 1. If the destination unit's
inter-flow is smaller than the source unit's inter-flow multiplied by this
ratio, the merge is stopped. Defaults to NULL (off).
Regardless of the value of opt_f, the inter-flow size is evaluated based on
absolute values.}

\item{non_zero}{A logical value. If TRUE, the algorithm stops when all potential
source units have non-zero inter-flows. Defaults to FALSE.}

\item{save_k}{Specifies whether to return the F_matrix and C_matrix for all
iterations. Defaults to FALSE.}
}
\value{
A list containing:
\itemize{
\item \code{unit_set}: Details of cluster assignment for each unit.
\item \code{cluster_set}: Statistics for the final clusters.
\item \code{F_matrix}: The final aggregated flow matrix.
\item \code{F_matrix_history}: (Optional) A list of matrices from each clustering round.
\item \code{C_matrix_history}: (Optional) A list of transformation matrices.
}
}
\description{
This function is an R translation of the flowbca.ado Stata package
by Jordy Meekes (2018). It implements a hierarchical clustering algorithm
for flow data, including the detailed tie-breaking rules from the original
Mata implementation.
}
